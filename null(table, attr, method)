#download packages
import pandas as pd
import numpy as np

#find the null row
def is_null(x):
    limit = len(x)
    count = 0
    null = np.array([])
    for i in range(len(x)):
        if x.isnull()[i]:
            null = np.append(null,i)
    return(null)
    
#find not null row
def not_null(x):
    limit = len(x)
    count = 0
    n_null = np.array([])
    for i in range(len(x)):
        if ~x.isnull()[i]:
            n_null = np.append(n_null,i)
    return(n_null)
    
#main function
def null(table, attr, method):
    if method == "dr":
        null_row = is_null(table[attr])
        table = table.drop(null_row)
    elif method == "dc":
        if (table[attr].isnull().sum()>0):
            table=table.drop(attr,axis=1)
    elif method == "rz":
        null_row = is_null(table[attr])
        table[attr][null_row] = 0
    elif method == "ra":
        null_row = is_null(table[attr])
        not_null_row = not_null(table[attr])
        rest_mean = table[attr][not_null_row].mean()
        table[attr][null_row] = rest_mean
    elif method == "rm":
        mode = table[attr].mode()
        null_row = is_null(table[attr])
        table[attr][null_row] = mode
    elif method == "rn":
        null_row = is_null(table[attr])
        not_null_row = not_null(table[attr])
        rest_mean = table[attr][not_null_row].mean()
        rest_var = table[attr][not_null_row].var()
        if np.isnan(rest_mean):
            rest_mean = 0
        if np.isnan(rest_var):
            rest_var = 1
        table[attr][null_row] = np.random.normal(rest_mean,rest_var,size=len(is_null(table[attr])))
    elif type(method) == str:
        null_row = is_null(table[attr])
        table[attr][null_row] = method
    else:
        null_row = is_null(table[attr])
        table[attr][null_row] = method
    return table
